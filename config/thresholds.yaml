# =============================================================================
# ARGUS - Detection Thresholds
# =============================================================================
# IMPORTANT: These are CONSERVATIVE initial values for observation mode.
# After Week 3 analysis, thresholds may be adjusted based on real data.
#
# ⚠️ 90-DAY RULE: After bot deployment, DO NOT change these for 90 days!
# This discipline prevents curve-fitting to noise.
# =============================================================================

# -----------------------------------------------------------------------------
# Detector #1: Funding Rate Mean Reversion
# Strategy: Enter opposite direction when funding rates spike to extremes
# -----------------------------------------------------------------------------
funding_rate:
  enabled: true
  
  # Entry Criteria
  threshold_percent: 0.08    # 8 bps per 8h (annualized: ~35%)
  z_score_threshold: 2.5     # 2.5 standard deviations above mean
  lookback_periods: 30       # Compare to last 30 funding periods (10 days)
  
  # Filters (only trade liquid markets)
  min_volume_usd: 50000000   # 50M+ daily volume
  min_open_interest: 100000000  # 100M+ open interest
  
  # Exit Criteria
  take_profit_threshold: 0.03  # Close when funding normalizes to 3 bps
  stop_loss_percent: 1.5       # Stop loss at -1.5%
  max_hold_hours: 48           # Force close after 48h
  
  # Position Sizing
  position_size_percent: 10    # 10% of capital per trade
  max_leverage: 3

# -----------------------------------------------------------------------------
# Detector #2: Spot-Perp Basis Arbitrage
# Strategy: Profit from price divergence between spot and perpetual
# -----------------------------------------------------------------------------
basis_arbitrage:
  enabled: true
  
  # Spot-perp price difference
  threshold_percent: 0.5       # 50 bps difference
  min_edge_after_fees_bps: 10  # Must have 10+ bps net edge
  max_hold_hours: 24           # Expected convergence time
  
  # Filters
  min_volume_spot: 10000000    # 10M+ spot volume
  min_volume_perp: 50000000    # 50M+ perp volume

# -----------------------------------------------------------------------------
# Detector #3: Cross-Exchange Arbitrage
# Strategy: Same asset at different prices on different exchanges
# -----------------------------------------------------------------------------
cross_exchange:
  enabled: true
  
  # Price discrepancies between exchanges
  threshold_percent: 0.15      # 15 bps difference
  min_edge_after_fees_bps: 5   # 5+ bps net edge
  
  # Exchanges to compare (US-friendly)
  exchanges:
    - "bybit"
    - "coinbase"
    - "okx"
  
  # Execution constraints
  max_execution_seconds: 10    # Must complete both legs within 10s
  min_liquidity_depth_usd: 100000  # 100k liquidity on both sides

# -----------------------------------------------------------------------------
# Detector #4: Post-Liquidation Snapback
# Strategy: Fade large liquidation cascades
# -----------------------------------------------------------------------------
liquidation:
  enabled: true
  
  # Liquidation cascade detection
  min_liquidation_usd: 5000000  # 5M+ liquidations
  time_window_minutes: 5        # Within 5 minutes
  
  # Snapback criteria
  snapback_threshold_percent: 0.3  # Expect 30+ bps bounce
  entry_delay_seconds: 30          # Wait 30s after cascade peak
  
  # Exit
  take_profit_percent: 0.5   # Take profit at 50 bps
  stop_loss_percent: 1.0     # Stop at -1%
  max_hold_minutes: 30       # Quick trade

# -----------------------------------------------------------------------------
# Detector #5: BTC Options IV Spike (MANUAL TRADING)
# Strategy: Sell premium when IV spikes during panic
# NOTE: This detector alerts YOU - it does not auto-trade
# -----------------------------------------------------------------------------
options_iv:
  enabled: true
  
  # Implied volatility spike detection
  threshold_percent: 80        # IV > 80% annualized
  z_score_threshold: 2.0       # 2+ std devs above mean
  lookback_days: 30            # Compare to 30-day average
  
  # Option selection criteria (for your manual trades)
  min_days_to_expiry: 3        # At least 3 days to expiry
  max_days_to_expiry: 14       # Max 2 weeks
  otm_percent: 10              # 10% out of the money
  
  # Position limits (YOUR capital allocation)
  max_position_size: 600       # Max $600 per trade
  max_positions: 3             # Max 3 open positions

# -----------------------------------------------------------------------------
# Detector #6: Volatility Regime Changes
# Strategy: Detect sudden expansion/compression in volatility
# NOTE: Provides context for other strategies, not standalone trades
# -----------------------------------------------------------------------------
volatility:
  enabled: true
  
  # Realized volatility windows
  short_window_hours: 1
  long_window_hours: 24
  
  # Thresholds
  expansion_threshold: 2.0     # 2x normal volatility = expansion
  compression_threshold: 0.5   # 0.5x normal volatility = compression
  
  # Requirements
  min_observations: 60         # Need 60+ data points

# -----------------------------------------------------------------------------
# Detector #7: IBIT Options Opportunity (MANUAL TRADING)
# Strategy: Sell put spreads on IBIT when BTC volatility spikes
# NOTE: This detector alerts YOU to check Robinhood for opportunities
# 
# OPTIMIZED 2026-01-30 via scripts/optimize.py
# -----------------------------------------------------------------------------
ibit:
  enabled: true
  
  # Alert triggers (OPTIMIZED VALUES)
  btc_iv_threshold: 25           # BTC IV > 25% (from Deribit) - LOWERED for more signals
  ibit_drop_threshold: -0.5      # IBIT dropped > 0.5% today - LOWERED for more signals
  iv_rank_threshold: 25          # IV Rank > 25%
  combined_score_threshold: 1.0  # Combined condition score
  
  # Cooldown to prevent alert spam
  cooldown_hours: 2              # Min 2h between alerts (was 4)
  
  # Suggested trade parameters (for your Robinhood trades)
  otm_percent_short: 8           # Short strike 8% OTM
  otm_percent_long: 16           # Long strike 16% OTM (8% spread width)
  target_expiry_days: 14         # 2-week options preferred
  profit_target: 0.70            # Close at 70% profit (was 50%)
  time_exit_dte: 5               # Exit at 5 DTE
  
  # Position limits
  max_position_size: 1000        # Max $1000 per spread
  max_open_positions: 3          # Max 3 concurrent positions
  
  # Paper trading
  paper_trading: true            # Log paper trades
  account_size: 3000             # For position sizing

# -----------------------------------------------------------------------------
# Detector #8: BITO Options Opportunity (MANUAL TRADING)
# Strategy: Same as IBIT - sell put spreads on crypto volatility
# BITO = ProShares Bitcoin Strategy ETF (tracks BTC futures)
# Adding this DOUBLES your trade opportunities
# -----------------------------------------------------------------------------
bito:
  enabled: true
  
  # Alert triggers (same as IBIT)
  btc_iv_threshold: 25
  drop_threshold: -0.5
  iv_rank_threshold: 25
  combined_score_threshold: 1.0
  
  # Cooldown
  cooldown_hours: 2
  
  # Trade parameters
  otm_percent_short: 8
  otm_percent_long: 16
  target_expiry_days: 14
  profit_target: 0.70
  time_exit_dte: 5
  
  # Position limits (shared with IBIT)
  max_position_size: 1000
  max_open_positions: 3          # 3 BITO + 3 IBIT = 6 total max
  
  # Paper trading
  paper_trading: true
  account_size: 3000

# -----------------------------------------------------------------------------
# GAP RISK TRACKER
# Monitors BTC price gaps during market-closed hours (nights, weekends)
# Alerts when significant moves could impact IBIT/BITO at market open
# -----------------------------------------------------------------------------
gap_risk:
  enabled: true
  
  # Thresholds (adjusted for higher risk tolerance)
  info_threshold_pct: 5          # Log only, no alert
  elevated_threshold_pct: 8      # Telegram FYI
  high_threshold_pct: 12         # Immediate alert, suggest reduced size
  extreme_threshold_pct: 15      # Circuit breaker suggested
  
  # Alert schedule (EST timezone)
  sunday_alert_hour: 20          # 8 PM ET
  monday_alert_hour: 8           # 8 AM ET
  
  # Position adjustment recommendations
  reduce_size_above_pct: 12      # Suggest 50% position size
  skip_trades_above_pct: 15      # Suggest no new trades

# -----------------------------------------------------------------------------
# REDDIT SENTIMENT
# Scrapes crypto subreddits for retail sentiment
# Uses STRICT bot filtering: 90+ days old, 500+ karma
# -----------------------------------------------------------------------------
reddit_sentiment:
  enabled: true
  
  # Subreddits to monitor
  subreddits:
    - Bitcoin
    - CryptoCurrency
    - wallstreetbets
  
  # Bot filtering (STRICT)
  min_account_age_days: 90       # Account must be older than 90 days
  min_karma: 500                  # Must have 500+ total karma
  
  # Update frequency
  poll_interval_minutes: 15      # How often to fetch new data
  cache_ttl_minutes: 15          # How long to cache results
  
  # Thresholds for alerts
  extreme_fear_threshold: -50    # Contrarian bullish below this
  extreme_greed_threshold: 70    # Crowded trade warning above this
